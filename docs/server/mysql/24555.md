---
title: 超卖现象的解决方案
ID: '24555'
date: '2020-03-16 21:17:38'
categories:
  - server
  - mysql
tags:
  - server
  - mysql
---

# 超卖现象的解决方案

**1、悲观锁方案**， update 时使用 for update

**2、无符号类型字段**，把库存字段设置无符号整型，更新库存少于0时会报错

**3、乐观锁方案**

- 使用 case 语句，即 when 库存>=扣减数 then 库存-扣减数
- 使用 where 语句，即 where 库存>=扣减数

性能比较：乐观锁 > 无符号类型字段 > 悲观锁

建议方案： **无符号类型字段 + 乐观锁** 双重保险方案
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
