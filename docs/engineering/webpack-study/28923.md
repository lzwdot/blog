---
 title: "webpack 性能优化"
 ID: "28923"
 date: "2021-12-30 21:46:17"
 author: "lzw."
 categories: 
  - "engineering"
  - "webpack-study"
 tags: 
  - "engineering"
  - "webpack-study"
---

# webpack 性能优化

### 开启 `sourcemap`

配置 `devtool` 为 `sourcemap` 快熟定位错误代码源文件

```js
module.exports = {
   // 生产环境是否开启，根据具体需要，一把如果有监控系统，建议开启
  devtool: 'source-map',
}
```

这样入口 `index.js` 就会生产同样的映射关系文件 `index.js.map`
> 具体配置参考：https://webpack.docschina.org/configuration/devtool/#devtool

### 使用 `webpack-dev-server` 服务

提高本地开发效率：热更新，本地数据 mock

配置 `package.json` 使用 `webpack-dev-server` 

```json
{
  "scripts": {   
    "serve": "webpack-dev-server"
  },
}
```

然后在 `wepack.config.js` 配置

```js
module.exports = {
  devServer: {
    port: 8081, // 端口
    open: true, // 自动打开浏览器
  },
}
```

本地数据 mock 测试，安装 express 和 axois

```sh
npm i -D express axios
```

新建根目录文件 `server.js`, 执行 `node server.js` 开启服务端

```js
const express = require('express')
const app = express()

app.get('/api/info', (req, res) => {
  res.json({
    name: 'webpack'
  })
})

app.listen('8090')
```

在入口 `index.js` 中测试

```js
import axios from "axios";

axios.get('/api/info').then(res => {
  console.log(res)
})
```

此时会报错，还需要配置代理访问，在 `wepack.config.js` 配置

```js
module.exports = {
  devServer: {
    proxy: { // 代理访问
      '/api': {
        target: 'http://localhost:8090/'
      }
    }
  },
}
```

### `babel` 工具

用于编译 js 的，默认支持 js, json 模块，对于目标浏览器，我们需要转换：

```
flow -> js
jsx -> js
ts -> js
es6+ -> js
```

那么走起，首先安装 `babel` 工具

```sh
npm i -D babel-loader @babel/core @babel/preset-env
```
> babel v7 之后，都是以 `@babel` 开头的仓库    
> `@babel/preset-env` 只做语法转换，es6+ -> es5

在 `wepack.config.js` 配置使用

```js
module.exports = {
   module: {
    rules: [
      {
        test: /\.js$/,
        use: {
          loader: "babel-loader",
          options: {
            presets: ['@babel/preset-env']
          }
        }
      }
    ]
   }
}
```




