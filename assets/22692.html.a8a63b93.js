import{h as n}from"./app.4ca8afde.js";import{_ as s}from"./plugin-vue_export-helper.21dcd24c.js";var a="/blog/assets/1345407982.8be3c0df.jpg";const p={},t=n('<h1 id="mysql-php\u548Cjs\u6839\u636E\u7ECF\u7EAC\u5EA6\u8BA1\u7B97\u8DDD\u79BB" tabindex="-1"><a class="header-anchor" href="#mysql-php\u548Cjs\u6839\u636E\u7ECF\u7EAC\u5EA6\u8BA1\u7B97\u8DDD\u79BB" aria-hidden="true">#</a> mysql\uFF0Cphp\u548Cjs\u6839\u636E\u7ECF\u7EAC\u5EA6\u8BA1\u7B97\u8DDD\u79BB</h1><h3 id="\u6839\u636E\u7ECF\u7EAC\u5EA6\u8BA1\u7B97\u8DDD\u79BB\u516C\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u6839\u636E\u7ECF\u7EAC\u5EA6\u8BA1\u7B97\u8DDD\u79BB\u516C\u5F0F" aria-hidden="true">#</a> \u6839\u636E\u7ECF\u7EAC\u5EA6\u8BA1\u7B97\u8DDD\u79BB\u516C\u5F0F</h3><p><img src="'+a+`" alt=""></p><blockquote><p>\u56FE\u7247\u6765\u81EA\u4E92\u8054\u7F51</p></blockquote><p>\u5BF9\u4E0A\u9762\u7684\u516C\u5F0F\u89E3\u91CA\u5982\u4E0B\uFF1A</p><ol><li>Lung1 Lat1\u8868\u793AA\u70B9\u7ECF\u7EAC\u5EA6\uFF0C Lung2 Lat2\u8868\u793AB\u70B9\u7ECF\u7EAC\u5EA6\uFF1B</li><li>a=Lat1 \u2013 Lat2 \u4E3A\u4E24\u70B9\u7EAC\u5EA6\u4E4B\u5DEE b=Lung1 -Lung2 \u4E3A\u4E24\u70B9\u7ECF\u5EA6\u4E4B\u5DEE\uFF1B</li><li>6378.137\u4E3A\u5730\u7403\u534A\u5F84\uFF0C\u5355\u4F4D\u4E3A\u5343\u7C73\uFF1B</li><li>\u8BA1\u7B97\u51FA\u6765\u7684\u7ED3\u679C\u5355\u4F4D\u4E3A\u5343\u7C73\uFF0C\u82E5\u5C06\u534A\u5F84\u6539\u4E3A\u7C73\u4E3A\u5355\u4F4D\u5219\u8BA1\u7B97\u7684\u7ED3\u679C\u5355\u4F4D\u4E3A\u7C73\u3002</li><li>\u8BA1\u7B97\u7CBE\u5EA6\u4E0E\u8C37\u6B4C\u5730\u56FE\u7684\u8DDD\u79BB\u7CBE\u5EA6\u5DEE\u4E0D\u591A\uFF0C\u76F8\u5DEE\u8303\u56F4\u57280.2\u7C73\u4EE5\u4E0B\u3002</li></ol><h3 id="\u53C2\u6570\u8BF4\u660E" tabindex="-1"><a class="header-anchor" href="#\u53C2\u6570\u8BF4\u660E" aria-hidden="true">#</a> \u53C2\u6570\u8BF4\u660E</h3><p>lng\uFF1A\u7ECF\u5EA6<br> lat\uFF1A\u7EAC\u5EA6<br> \u5730\u7403\u534A\u5F84\uFF1A6378.137\uFF08\u5343\u7C73\uFF09</p><p>\u4E00\u822C\u5730\u56FE\u4E0A\u663E\u793A\u7684\u5750\u6807\u987A\u5E8F\u4E3A\uFF0C\u7EAC\u5EA6\u5728\u524D\uFF08\u8303\u56F4-90 ~ 90\uFF09\uFF0C\u7ECF\u5EA6\u5728\u540E\uFF08\u8303\u56F4-180 ~ 180\uFF09</p><h3 id="\u5404\u79CD\u8BED\u8A00\u8BA1\u7B97\u8DDD\u79BB\u7684\u4EE3\u7801" tabindex="-1"><a class="header-anchor" href="#\u5404\u79CD\u8BED\u8A00\u8BA1\u7B97\u8DDD\u79BB\u7684\u4EE3\u7801" aria-hidden="true">#</a> \u5404\u79CD\u8BED\u8A00\u8BA1\u7B97\u8DDD\u79BB\u7684\u4EE3\u7801</h3><blockquote><p>\u8FD9\u79CD\u8BA1\u7B97\u65B9\u5F0F\u4E00\u822C\u90FD\u662F\u76F4\u7EBF\u8DDD\u79BB</p></blockquote><p>sql\u8BED\u53E5</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token constant">SELECT</span>
    <span class="token operator">*</span><span class="token punctuation">,</span>
    <span class="token number">6378.138</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token constant">ASIN</span><span class="token punctuation">(</span>
      <span class="token constant">SQRT</span><span class="token punctuation">(</span>
        <span class="token constant">POW</span><span class="token punctuation">(</span>
          <span class="token constant">SIN</span><span class="token punctuation">(</span>
            <span class="token punctuation">(</span>
              <span class="token string">&#39;.$lat.&#39;</span> <span class="token operator">*</span> <span class="token constant">PI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">180</span> <span class="token operator">-</span> lat <span class="token operator">*</span> <span class="token constant">PI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">180</span>
            <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
          <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span>
        <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">COS</span><span class="token punctuation">(</span><span class="token string">&#39;.$lat.&#39;</span> <span class="token operator">*</span> <span class="token constant">PI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token constant">COS</span><span class="token punctuation">(</span>lat <span class="token operator">*</span> <span class="token constant">PI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token constant">POW</span><span class="token punctuation">(</span>
          <span class="token constant">SIN</span><span class="token punctuation">(</span>
            <span class="token punctuation">(</span>
              <span class="token string">&#39;.$lng.&#39;</span> <span class="token operator">*</span> <span class="token constant">PI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">180</span> <span class="token operator">-</span> lng <span class="token operator">*</span> <span class="token constant">PI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">180</span>
            <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
          <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">)</span> <span class="token operator">*</span><span class="token number">1000</span> <span class="token constant">AS</span> distance
<span class="token constant">FROM</span>
    distance
<span class="token constant">ORDER</span> <span class="token constant">BY</span>
    distance <span class="token constant">ASC</span>
</code></pre></div><p>php\u8BA1\u7B97\u8DDD\u79BB</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * \u6839\u636E\u4E24\u70B9\u95F4\u7684\u7ECF\u7EAC\u5EA6\u8BA1\u7B97\u8DDD\u79BB
 * <span class="token keyword">@param</span> <span class="token parameter">$lng1</span>
 * <span class="token keyword">@param</span> <span class="token parameter">$lat1</span>
 * <span class="token keyword">@param</span> <span class="token parameter">$lng2</span>
 * <span class="token keyword">@param</span> <span class="token parameter">$lat2</span>
 * <span class="token keyword">@return</span> int
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">getDistance</span><span class="token punctuation">(</span><span class="token parameter">$lng1<span class="token punctuation">,</span> $lat1<span class="token punctuation">,</span> $lng2<span class="token punctuation">,</span> $lat2</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//\u5C06\u89D2\u5EA6\u8F6C\u4E3A\u72D0\u5EA6</span>
    $radLat1 <span class="token operator">=</span> <span class="token function">deg2rad</span><span class="token punctuation">(</span>$lat1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//deg2rad()\u51FD\u6570\u5C06\u89D2\u5EA6\u8F6C\u6362\u4E3A\u5F27\u5EA6</span>
    $radLat2 <span class="token operator">=</span> <span class="token function">deg2rad</span><span class="token punctuation">(</span>$lat2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    $radLng1 <span class="token operator">=</span> <span class="token function">deg2rad</span><span class="token punctuation">(</span>$lng1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    $radLng2 <span class="token operator">=</span> <span class="token function">deg2rad</span><span class="token punctuation">(</span>$lng2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    $a <span class="token operator">=</span> $radLat1 <span class="token operator">-</span> $radLat2<span class="token punctuation">;</span>
    $b <span class="token operator">=</span> $radLng1 <span class="token operator">-</span> $radLng2<span class="token punctuation">;</span>
    $s <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token function">asin</span><span class="token punctuation">(</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token function">sin</span><span class="token punctuation">(</span>$a <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">cos</span><span class="token punctuation">(</span>$radLat1<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>$radLat2<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">pow</span><span class="token punctuation">(</span><span class="token function">sin</span><span class="token punctuation">(</span>$b <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">6378.137</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> $s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>js\u6C42\u8DDD\u79BB\u7684\u65B9\u6CD5</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * \u8F6C\u6362\u5F27\u5EA6
 * <span class="token keyword">@param</span> <span class="token parameter">d</span>
 * <span class="token keyword">@returns</span> <span class="token class-name"><span class="token punctuation">{</span>number<span class="token punctuation">}</span></span>
 */</span>
<span class="token keyword">function</span> <span class="token function">getRad</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> <span class="token constant">PI</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> d<span class="token operator">*</span><span class="token constant">PI</span><span class="token operator">/</span><span class="token number">180.0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token doc-comment comment">/**
 * \u6839\u636E\u7ECF\u7EAC\u5EA6\u8BA1\u7B97\u4E24\u70B9\u95F4\u8DDD\u79BB
 * <span class="token keyword">@param</span> <span class="token parameter">lng1</span>
 * <span class="token keyword">@param</span> <span class="token parameter">lat1</span>
 * <span class="token keyword">@param</span> <span class="token parameter">lng2</span>
 * <span class="token keyword">@param</span> <span class="token parameter">lat2</span>
 * <span class="token keyword">@returns</span> <span class="token class-name"><span class="token punctuation">{</span>number<span class="token operator">|</span><span class="token operator">*</span><span class="token punctuation">}</span></span>
 * <span class="token keyword">@constructor</span>
 */</span>
<span class="token keyword">function</span> <span class="token function">CoolWPDistance</span><span class="token punctuation">(</span><span class="token parameter">lng1<span class="token punctuation">,</span>lat1<span class="token punctuation">,</span>lng2<span class="token punctuation">,</span>lat2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token function">getRad</span><span class="token punctuation">(</span><span class="token punctuation">(</span>lat1 <span class="token operator">+</span> lat2<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> g <span class="token operator">=</span> <span class="token function">getRad</span><span class="token punctuation">(</span><span class="token punctuation">(</span>lat1 <span class="token operator">-</span> lat2<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> l <span class="token operator">=</span> <span class="token function">getRad</span><span class="token punctuation">(</span><span class="token punctuation">(</span>lng1 <span class="token operator">-</span> lng2<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> sg <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> sl <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> sf <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> s<span class="token punctuation">,</span>c<span class="token punctuation">,</span>w<span class="token punctuation">,</span>r<span class="token punctuation">,</span>d<span class="token punctuation">,</span>h1<span class="token punctuation">,</span>h2<span class="token punctuation">;</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">6378137.0</span><span class="token punctuation">;</span><span class="token comment">//The Radius of eath in meter.</span>
    <span class="token keyword">var</span> fl <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">298.257</span><span class="token punctuation">;</span>
    sg <span class="token operator">=</span> sg<span class="token operator">*</span>sg<span class="token punctuation">;</span>
    sl <span class="token operator">=</span> sl<span class="token operator">*</span>sl<span class="token punctuation">;</span>
    sf <span class="token operator">=</span> sf<span class="token operator">*</span>sf<span class="token punctuation">;</span>
    s <span class="token operator">=</span> sg<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>sl<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>sf<span class="token punctuation">)</span><span class="token operator">*</span>sl<span class="token punctuation">;</span>
    c <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>sg<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>sl<span class="token punctuation">)</span> <span class="token operator">+</span> sf<span class="token operator">*</span>sl<span class="token punctuation">;</span>
    w <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">atan</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>s<span class="token operator">/</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    r <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>s<span class="token operator">*</span>c<span class="token punctuation">)</span><span class="token operator">/</span>w<span class="token punctuation">;</span>
    d <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>w<span class="token operator">*</span>a<span class="token punctuation">;</span>
    h1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>r <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">/</span>c<span class="token punctuation">;</span>
    h2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>r <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">/</span>s<span class="token punctuation">;</span>
    s <span class="token operator">=</span> d<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> fl<span class="token operator">*</span><span class="token punctuation">(</span>h1<span class="token operator">*</span>sf<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>sg<span class="token punctuation">)</span> <span class="token operator">-</span> h2<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>sf<span class="token punctuation">)</span><span class="token operator">*</span>sg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>s <span class="token operator">&gt;=</span> <span class="token number">1000</span> <span class="token operator">&amp;&amp;</span> s <span class="token operator">&lt;=</span> <span class="token number">99000</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> kilometer <span class="token operator">=</span> s<span class="token operator">/</span><span class="token number">1000</span><span class="token punctuation">;</span>
        s <span class="token operator">=</span> kilometer<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;km&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>s <span class="token operator">&gt;</span> <span class="token number">99000</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        s <span class="token operator">=</span> <span class="token string">&#39;&gt;99km&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        s <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;m&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// s = s/1000;</span>
    <span class="token comment">// s = s.toFixed(2);//\u6307\u5B9A\u5C0F\u6570\u70B9\u540E\u7684\u4F4D\u6570\u3002</span>
    <span class="token keyword">return</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>\u4EE5\u4E0A\u4EE3\u7801\u5927\u90E8\u5206\u6765\u81EA\u7F51\u4E0A\u6536\u96C6\uFF0C\u7ECF\u8FC7\u9A8C\u8BC1\u8FC7\u7684\uFF0C\u53EF\u4EE5\u4F7F\u7528</p>`,18);function o(e,c){return t}var u=s(p,[["render",o]]);export{u as default};
