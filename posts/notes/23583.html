<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.35">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="stylesheet" href="//unpkg.com/element-ui@2.15.5/lib/theme-chalk/index.css"><link rel="apple-touch-icon" sizes="180x180" href="/blog/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/favicon-16x16.png"><link rel="manifest" href="/blog/site.webmanifest"><link rel="mask-icon" href="/blog/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><script>var _hmt = _hmt || [];
            (function () {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?96d91412aff9543cd8e022f381d8bf1c";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();</script><title>Security AppScan Standard常见漏洞 | Lzw's 笔记</title><meta name="description" content="记录和分享，每天进步一点点！">
    <link rel="modulepreload" href="/blog/assets/app.4ca8afde.js"><link rel="modulepreload" href="/blog/assets/23583.html.256fa96d.js"><link rel="modulepreload" href="/blog/assets/23583.html.abf93c32.js"><link rel="modulepreload" href="/blog/assets/plugin-vue_export-helper.21dcd24c.js">
    <link rel="stylesheet" href="/blog/assets/style.1c838ac8.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/blog/" class=""><!----><span class="site-name">Lzw&#39;s 笔记</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/blog/pages/category" class="" aria-label="分类"><!--[--><!--]--> 分类 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/pages/about" class="" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://lzwdot.github.io" rel="noopener noreferrer" target="_blank" aria-label="GitHub主页"><!--[--><!--]--> GitHub主页 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="切换夜间模式"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/blog/pages/category" class="" aria-label="分类"><!--[--><!--]--> 分类 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/pages/about" class="" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://lzwdot.github.io" rel="noopener noreferrer" target="_blank" aria-label="GitHub主页"><!--[--><!--]--> GitHub主页 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">随笔 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/blog/posts/notes/21997.html" class="sidebar-item" aria-label="JMeter接口测试，Response Data返回中文乱码和json数据转码"><!--[--><!--]--> JMeter接口测试，Response Data返回中文乱码和json数据转码 <!--[--><!--]--></a><!----></li><li><a href="/blog/posts/notes/22825.html" class="sidebar-item" aria-label="Web代理工具对比"><!--[--><!--]--> Web代理工具对比 <!--[--><!--]--></a><!----></li><li><a href="/blog/posts/notes/22835.html" class="sidebar-item" aria-label="PhpStorm历史版本下载和激活"><!--[--><!--]--> PhpStorm历史版本下载和激活 <!--[--><!--]--></a><!----></li><li><a href="/blog/posts/notes/22938.html" class="sidebar-item" aria-label="80端口被system(pid=4)占用的解决方法"><!--[--><!--]--> 80端口被system(pid=4)占用的解决方法 <!--[--><!--]--></a><!----></li><li><a href="/blog/posts/notes/23497.html" class="sidebar-item" aria-label="Beyond Compare 试用期结束解决办法"><!--[--><!--]--> Beyond Compare 试用期结束解决办法 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/posts/notes/23583.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Security AppScan Standard常见漏洞"><!--[--><!--]--> Security AppScan Standard常见漏洞 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog/posts/notes/23583.html#已启用目录" class="router-link-active router-link-exact-active sidebar-item" aria-label="已启用目录"><!--[--><!--]--> 已启用目录 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/posts/notes/23583.html#加密会话-ssl-cookie-中缺少-secure-属性-php" class="router-link-active router-link-exact-active sidebar-item" aria-label="加密会话（SSL）Cookie 中缺少 Secure 属性（PHP）"><!--[--><!--]--> 加密会话（SSL）Cookie 中缺少 Secure 属性（PHP） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/posts/notes/23583.html#不安全的http方法" class="router-link-active router-link-exact-active sidebar-item" aria-label="不安全的HTTP方法"><!--[--><!--]--> 不安全的HTTP方法 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/posts/notes/23583.html#服务器端banner泄漏" class="router-link-active router-link-exact-active sidebar-item" aria-label="服务器端Banner泄漏"><!--[--><!--]--> 服务器端Banner泄漏 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/posts/notes/23583.html#使用伪造的-url-设置-referer-头" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用伪造的 URL 设置 Referer 头"><!--[--><!--]--> 使用伪造的 URL 设置 Referer 头 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/posts/notes/23583.html#关闭apache下icons目录列表" class="router-link-active router-link-exact-active sidebar-item" aria-label="关闭apache下icons目录列表"><!--[--><!--]--> 关闭apache下icons目录列表 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/posts/notes/23583.html#flash-参数-allowscriptaccess-已设置为-always" class="router-link-active router-link-exact-active sidebar-item" aria-label="Flash 参数 AllowScriptAccess 已设置为 always"><!--[--><!--]--> Flash 参数 AllowScriptAccess 已设置为 always <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/posts/notes/23583.html#appscan检测到隐藏目录" class="router-link-active router-link-exact-active sidebar-item" aria-label="AppScan检测到隐藏目录"><!--[--><!--]--> AppScan检测到隐藏目录 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/posts/notes/23583.html#缺少跨帧脚本编制防御" class="router-link-active router-link-exact-active sidebar-item" aria-label="缺少跨帧脚本编制防御"><!--[--><!--]--> 缺少跨帧脚本编制防御 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/posts/notes/23583.html#发现可高速缓存的-ssl-页面" class="router-link-active router-link-exact-active sidebar-item" aria-label="发现可高速缓存的 SSL 页面"><!--[--><!--]--> 发现可高速缓存的 SSL 页面 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/posts/notes/23583.html#缺少-http-strict-transport-security-头" class="router-link-active router-link-exact-active sidebar-item" aria-label="缺少 HTTP Strict-Transport-Security 头"><!--[--><!--]--> 缺少 HTTP Strict-Transport-Security 头 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/posts/notes/23583.html#缺少-content-security-policy-头" class="router-link-active router-link-exact-active sidebar-item" aria-label="缺少“Content-Security-Policy”头"><!--[--><!--]--> 缺少“Content-Security-Policy”头 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/posts/notes/23583.html#缺少-x-content-type-options-头" class="router-link-active router-link-exact-active sidebar-item" aria-label="缺少“X-Content-Type-Options”头"><!--[--><!--]--> 缺少“X-Content-Type-Options”头 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/posts/notes/23583.html#缺少-x-xss-protection-头" class="router-link-active router-link-exact-active sidebar-item" aria-label="缺少“X-XSS-Protection”头"><!--[--><!--]--> 缺少“X-XSS-Protection”头 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a href="/blog/posts/notes/23595.html" class="sidebar-item" aria-label="进程与线程的通俗理解"><!--[--><!--]--> 进程与线程的通俗理解 <!--[--><!--]--></a><!----></li><li><a href="/blog/posts/notes/24227.html" class="sidebar-item" aria-label="开源的SQL可视化工具HeidiSQL"><!--[--><!--]--> 开源的SQL可视化工具HeidiSQL <!--[--><!--]--></a><!----></li><li><a href="/blog/posts/notes/24597.html" class="sidebar-item" aria-label="Jmeter添加TPS等图形化监控"><!--[--><!--]--> Jmeter添加TPS等图形化监控 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="security-appscan-standard常见漏洞" tabindex="-1"><a class="header-anchor" href="#security-appscan-standard常见漏洞" aria-hidden="true">#</a> Security AppScan Standard常见漏洞</h1><h2 id="已启用目录" tabindex="-1"><a class="header-anchor" href="#已启用目录" aria-hidden="true">#</a> 已启用目录</h2><p>需要关闭目录浏览索引</p><p><strong>Apache</strong>， 进入apache的配置文件 httpd.conf 修改</p><div class="language-javascript ext-js"><pre class="language-javascript"><code>DocumentRoot <span class="token string">&quot;E:/www&quot;</span>
<span class="token operator">&lt;</span>Directory <span class="token string">&quot;E:/www&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">...</span>
    #Options Indexes FollowSymLinks Includes ExecCGI
    Options FollowSymLinks Includes ExecCGI #去掉Indexes
  <span class="token operator">...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Directory<span class="token operator">&gt;</span>
</code></pre></div><p><strong>Nginx</strong>， 编辑nginx配置文件 nginx.conf，修改</p><div class="language-javascript ext-js"><pre class="language-javascript"><code>autoindex off<span class="token punctuation">;</span>  #开启nginx目录浏览功能<span class="token punctuation">,</span>on为开启<span class="token punctuation">,</span>off为关闭
</code></pre></div><p>以上都需要重载配置文件，才生效</p><h2 id="加密会话-ssl-cookie-中缺少-secure-属性-php" tabindex="-1"><a class="header-anchor" href="#加密会话-ssl-cookie-中缺少-secure-属性-php" aria-hidden="true">#</a> 加密会话（SSL）Cookie 中缺少 Secure 属性（PHP）</h2><p>使用https访问时， 需要给cookie加上Secure和HttpOnly属性， 但需要注意：</p><blockquote><p>设置HttpOnly=true的cookie不能被js获取到，无法用document.cookie打出cookie的内容。</p></blockquote><h4 id="_1-设置secure" tabindex="-1"><a class="header-anchor" href="#_1-设置secure" aria-hidden="true">#</a> 1. 设置secure</h4><p>可以看到,只要在<strong>setcookie</strong>第六个参数设置为true,就可以了</p><h4 id="_2-设置httponly" tabindex="-1"><a class="header-anchor" href="#_2-设置httponly" aria-hidden="true">#</a> 2. 设置httponly</h4><p>在5.1和之前的版本在header设置</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">?</span>php
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Set-Cookie: hidden=value; httpOnly&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><p>在5.2和更高的版本，Cookie 参数可以在 php.ini文件中定义，如果需要设置有几个选择</p><p><strong>1. 修改php全局配置</strong></p><div class="language-javascript ext-js"><pre class="language-javascript"><code>#<span class="token number">1</span><span class="token punctuation">)</span> 直接修改php<span class="token punctuation">.</span>ini文件
session<span class="token punctuation">.</span>cookie_httponly<span class="token operator">=</span><span class="token boolean">true</span>
#<span class="token number">2</span><span class="token punctuation">)</span> 此配置可以在php代码中使用<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ini_set</span><span class="token template-punctuation string">`</span></span>函数设置
<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string">&quot;session.cookie_httponly&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
#<span class="token number">3</span><span class="token punctuation">)</span>，在调用 <span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>之前调用 <span class="token function">session_set_cookie_params</span><span class="token punctuation">(</span><span class="token punctuation">)</span>函数设置
<span class="token operator">&lt;</span><span class="token operator">?</span>php
<span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">startSession</span><span class="token punctuation">(</span>$time <span class="token operator">=</span> <span class="token number">3600</span><span class="token punctuation">,</span> $ses <span class="token operator">=</span> <span class="token string">&#39;MYSES&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">session_set_cookie_params</span><span class="token punctuation">(</span>$time<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">session_name</span><span class="token punctuation">(</span>$ses<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span>$_COOKIE<span class="token punctuation">[</span>$ses<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      #第五个参数 设置为<span class="token boolean">true</span>
      <span class="token function">setcookie</span><span class="token punctuation">(</span>$ses<span class="token punctuation">,</span> $_COOKIE<span class="token punctuation">[</span>$ses<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> $time<span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">?</span><span class="token operator">&gt;</span> 
</code></pre></div><p><a href="https://php.net/manual/zh/function.session-set-cookie-params.php" target="_blank" rel="noopener noreferrer">session_set_cookie_params()<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a>函数<a href="https://php.net/manual/zh/function.session-start.php" target="_blank" rel="noopener noreferrer">session_start()<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 函数</p><p><strong>2. 在设置cookie时直接指定httponly</strong></p><p>前面介绍在setcookie函数第7个参数<strong>httponly</strong>设置为true即可.</p><blockquote><p>注意事项</p><p>setcookie的httponly参数 在5.2.0版本开始才有</p></blockquote><p>参考：<a href="https://www.jianshu.com/p/87a72c26db2a" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/87a72c26db2a<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></p><h2 id="不安全的http方法" tabindex="-1"><a class="header-anchor" href="#不安全的http方法" aria-hidden="true">#</a> 不安全的HTTP方法</h2><p>只允许post，get的http方法</p><p><strong>Apache</strong>在httpd.conf添加如下配置：</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token operator">&lt;</span>Location <span class="token string">&quot;/&quot;</span><span class="token operator">&gt;</span>
   AllowMethods <span class="token constant">GET</span> <span class="token constant">POST</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Location<span class="token operator">&gt;</span>
</code></pre></div><p>参考：<a href="https://httpd.apache.org/docs/2.4/mod/mod_allowmethods.html" target="_blank" rel="noopener noreferrer">https://httpd.apache.org/docs/2.4/mod/mod_allowmethods.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></p><p><strong>Nginx</strong>在nginx.conf中进行如下设置</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>$request_method <span class="token operator">!</span><span class="token operator">~</span> <span class="token operator">^</span><span class="token punctuation">(</span><span class="token constant">GET</span><span class="token operator">|</span><span class="token constant">HEAD</span><span class="token operator">|</span><span class="token constant">POST</span><span class="token punctuation">)</span>$ <span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token number">403</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="服务器端banner泄漏" tabindex="-1"><a class="header-anchor" href="#服务器端banner泄漏" aria-hidden="true">#</a> 服务器端Banner泄漏</h2><p>隐藏server信息和版本信息， nginx配置可以参考这篇文章 <a href="https://lzwdot.com/blog/archives/22789" target="_blank" rel="noopener noreferrer">https://lzwdot.com/blog/archives/22789<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></p><p>Apache配置隐藏版本号， 在httpd.conf添加如下配置：</p><div class="language-javascript ext-js"><pre class="language-javascript"><code># 找到ServerTokens和ServerSignature并修改为：
ServerTokens  Prod
ServerSignature  off
# 如果没有找到ServerTokens和ServerSignature可以在最后一行添加
</code></pre></div><p>php隐藏版本号，在php.ini中配置：</p><div class="language-javascript ext-js"><pre class="language-javascript"><code>expose_php<span class="token operator">=</span>Off
</code></pre></div><h2 id="使用伪造的-url-设置-referer-头" tabindex="-1"><a class="header-anchor" href="#使用伪造的-url-设置-referer-头" aria-hidden="true">#</a> 使用伪造的 URL 设置 Referer 头</h2><p>将可能干扰 CSRF 攻击的 HTTP 头除去，并使用伪造的 URL 设置 Referer 头进行访问，所以需要验证 Referer 头</p><blockquote><p>这种方式只能起到简单发防护， Referer 头是可以伪造的，更推荐使用csrf-token表单方式进行防护</p></blockquote><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span>$_SERVER<span class="token punctuation">[</span><span class="token string">&#39;HTTP_REFERER&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strpos</span><span class="token punctuation">(</span>$_SERVER<span class="token punctuation">[</span><span class="token string">&#39;HTTP_REFERER&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> $_SERVER<span class="token punctuation">[</span><span class="token string">&#39;SERVER_NAME&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">&#39;不允许的请求&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="关闭apache下icons目录列表" tabindex="-1"><a class="header-anchor" href="#关闭apache下icons目录列表" aria-hidden="true">#</a> 关闭apache下icons目录列表</h2><p>使用apache服务器，当我访问<a href="http://localhost/icons/%E6%97%B6%E4%BC%9A%E8%87%AA%E5%8A%A8%E6%98%BE%E7%A4%BA%E8%BF%99%E4%B8%AA%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E6%89%80%E4%BB%A5%E6%96%87%E4%BB%B6%E5%88%97%E8%A1%A8" target="_blank" rel="noopener noreferrer">http://localhost/icons/时会自动显示这个目录下的所以文件列表<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a>，出于安全考虑需要关闭目录列表</p><p>目录<code>apache/conf/extra/</code>下的文件<code>httpd-autoindex.conf</code>修改</p><div class="language-javascript ext-js"><pre class="language-javascript"><code>Alias <span class="token operator">/</span>icons<span class="token operator">/</span> <span class="token string">&quot;/xampp/apache/icons/&quot;</span>
<span class="token operator">&lt;</span>Directory <span class="token string">&quot;/xampp/apache/icons&quot;</span><span class="token operator">&gt;</span>
    #Options Indexes MultiViews
    Options MultiViews #去掉Indexes
    AllowOverride None
    Require all granted
<span class="token operator">&lt;</span><span class="token operator">/</span>Directory<span class="token operator">&gt;</span>
</code></pre></div><h2 id="flash-参数-allowscriptaccess-已设置为-always" tabindex="-1"><a class="header-anchor" href="#flash-参数-allowscriptaccess-已设置为-always" aria-hidden="true">#</a> Flash 参数 AllowScriptAccess 已设置为 always</h2><p>当显示有这个漏洞时，一般是js文件包了 <code>&lt;param name=&quot;allowscriptaccess&quot; value=&quot;always&quot; /&gt;</code> 参数，如<code>ueditor hird-partywebuploaderwebuploader.js</code>文件的大概6472行。一般建议修改为 <code>&lt;param name=&quot;allowscriptaccess&quot; value=&quot;sameDomain&quot; /&gt;</code></p><h2 id="appscan检测到隐藏目录" tabindex="-1"><a class="header-anchor" href="#appscan检测到隐藏目录" aria-hidden="true">#</a> AppScan检测到隐藏目录</h2><p>直接访问在站点根目录的css，images时，系统可能会返回 <code>403 forbidden</code> ，这时安全软件会觉得是一个不安全的方式配置。可能的话，请发出改用“404 － 找不到”响应状态代码，而不是“403 － 禁止”。这项更改会将站点的目录模糊化，可以防止泄漏站点结构。解决这个问题有两种方式，<strong>方式一是通过自定义 403 错误页面返回 404，即 403 的错误页面找不到</strong>：</p><p><strong>Nginx</strong> 在 sever 模块中配置</p><div class="language-javascript ext-js"><pre class="language-javascript"><code>location <span class="token operator">/</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
        error_page <span class="token number">403</span> <span class="token operator">/</span><span class="token number">404</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Apache</strong> 在 httpd.conf 文件中配置 <code>ErrorDocument 403 /404</code></p><p><strong>方法二</strong>是在css，image等目录中新建一个空白的 <code>index.html</code> 文件即可</p><h2 id="缺少跨帧脚本编制防御" tabindex="-1"><a class="header-anchor" href="#缺少跨帧脚本编制防御" aria-hidden="true">#</a> 缺少跨帧脚本编制防御</h2><p>一般使用 X-Frame-Options 防止（限制）在 iFrame 中嵌入页面，配置方法有：</p><p><strong>PHP</strong> 代码 <code>header(&#39;X-Frame-Options:Deny&#39;);</code> 或者 <code>header(&#39;X-Frame-Options:SAMEORIGIN);//觉得用这个比较好</code></p><p><strong>Nginx</strong> 配置 <code>add_header X-Frame-Options SAMEORIGIN</code></p><p><strong>Apache</strong> 配置 <code>Header always append X-Frame-Options SAMEORIGIN</code></p><h2 id="发现可高速缓存的-ssl-页面" tabindex="-1"><a class="header-anchor" href="#发现可高速缓存的-ssl-页面" aria-hidden="true">#</a> 发现可高速缓存的 SSL 页面</h2><p>一般建议页面标题中的“Cache-Control: no-store”和“Pragma: no-cache”或“Cache-Control: no-cache”响应伪指令来实现此操作，页面添加：</p><div class="language-javascript ext-js"><pre class="language-javascript"><code> <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">&quot;Cache-Control&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;no-cache, no-store&quot;</span><span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">&quot;Pragma&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;no-cache&quot;</span><span class="token operator">&gt;</span>     
</code></pre></div><p>告知浏览器不缓存页面；如果需要设置响应过期日期始终为过期，则添加 <code>&lt;meta http-equiv=&quot;Expires&quot; content=&quot;0&quot;&gt;</code> 浏览器会在这段时间之后更新缓存里的页面。如果使用Laravel框架，则可以中间件添加：</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">return</span> <span class="token function">$next</span><span class="token punctuation">(</span>$request<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Cache-Control&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;no-cache, no-store&#39;</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Pragma&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;no-cache&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="缺少-http-strict-transport-security-头" tabindex="-1"><a class="header-anchor" href="#缺少-http-strict-transport-security-头" aria-hidden="true">#</a> 缺少 HTTP Strict-Transport-Security 头</h2><p><strong>Nginx</strong> 配置 <code>add_header Strict-Transport-Security &quot;max-age=63072000; includeSubdomains&quot; always;</code></p><p><strong>Apache</strong> 配置 <code>Header always set Strict-Transport-Security &quot;max-age=63072000; includeSubdomains; preload&quot;</code></p><h2 id="缺少-content-security-policy-头" tabindex="-1"><a class="header-anchor" href="#缺少-content-security-policy-头" aria-hidden="true">#</a> 缺少“Content-Security-Policy”头</h2><p><strong>页面</strong> 添加 <code>&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;upgrade-insecure-requests&quot;&gt;</code></p><p><strong>Nginx</strong> 配置 <code>add_header Content-Security-Policy &quot;upgrade-insecure-requests;connect-src *&quot;;</code></p><p><strong>Apache</strong> 配置 <code>Header set Content-Security-Policy &quot;default-src &#39;self&#39;;&quot;</code></p><p>参考：</p><p><a href="https://www.uedbox.com/post/56310/" target="_blank" rel="noopener noreferrer">https://www.uedbox.com/post/56310/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></p><p><a href="https://www.cnblogs.com/hustskyking/p/upgrade-insecure-requests.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/hustskyking/p/upgrade-insecure-requests.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></p><h2 id="缺少-x-content-type-options-头" tabindex="-1"><a class="header-anchor" href="#缺少-x-content-type-options-头" aria-hidden="true">#</a> 缺少“X-Content-Type-Options”头</h2><p><strong>Nginx</strong> 配置 <code>add_header X-Content-Type-Options nosniff;</code></p><p><strong>Apache</strong> 配置 <code>Header always set X-Content-Type-Options nosniff</code></p><h2 id="缺少-x-xss-protection-头" tabindex="-1"><a class="header-anchor" href="#缺少-x-xss-protection-头" aria-hidden="true">#</a> 缺少“X-XSS-Protection”头</h2><p><strong>页面</strong>设置 <code>&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;X-XSS-Protection:1;mode=block&quot; /&gt;</code></p><p><strong>Nginx</strong> 配置 <code>add_header X-XSS-Protection &quot;1; mode=block&quot;;</code></p><p><strong>Apache</strong> <code>配置 Header always append X-XSS-Protection &quot;1;mode=block&quot;</code></p><blockquote><p>关于添加HTTP头部设，Nginx可以参考 <a href="https://www.jdon.com/idea/htmlcss/7-http-headers-to-secure-your-app.html" target="_blank" rel="noopener noreferrer">https://www.jdon.com/idea/htmlcss/7-http-headers-to-secure-your-app.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> ，Apache可以参考 <a href="http://itindex.net/detail/52305-apache-header-%E5%AE%89%E5%85%A8" target="_blank" rel="noopener noreferrer">http://itindex.net/detail/52305-apache-header-%E5%AE%89%E5%85%A8<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></p></blockquote><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/lzwdot/blog/edit/main/docs/posts/notes/23583.md" rel="noopener noreferrer" target="_blank" aria-label="编辑页面"><!--[--><!--]--> 编辑页面 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!----><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/blog/posts/notes/23497.html" class="" aria-label="Beyond Compare 试用期结束解决办法"><!--[--><!--]--> Beyond Compare 试用期结束解决办法 <!--[--><!--]--></a></span><span class="next"><a href="/blog/posts/notes/23595.html" class="" aria-label="进程与线程的通俗理解"><!--[--><!--]--> 进程与线程的通俗理解 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!----><!--]--></div>
    <script type="module" src="/blog/assets/app.4ca8afde.js" defer></script>
  </body>
</html>
